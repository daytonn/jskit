var JSkit=function(){if(!_)throw new Error("JSkit: lodash or underscore is required");return{createApplication:function(){return JSkit.Application.create()}}}();JSkit.Dispatcher=function(){function n(n,t){return n.__events__[t]=n.__events__[t]||[],n.__events__[t]}function t(n,t){return n=n||null,{context:n,handler:t}}function e(n,t,e){e=e||"push",r(n,t)||n[e](t)}var r=_.some,i=_.each,o=_.tail;return{create:function(){return{__events__:{},on:function(r,i,o){var c=t(o,i),a=n(this,r);e(a,c)},before:function(r,i,o){var c=t(o,i),a=n(this,r);e(a,c,"unshift")},off:function(n,t){var e=this.__events__[n];t?this.__events__[n]=_.reject(e,function(n){return n.handler!==t}):this.__events__[n]=[]},trigger:function(n){var t=this.__events__[n]||[],e=o(arguments);i(t,function(n){var t=n.handler,r=n.context;t.apply(r,e)})}}}}}(),JSkit.Controller=function(){function n(n){var t=["registerEvents","registerActions","cacheElements","eventNameForAction"];b(z(n),function(n){if(F(t,n))throw new Error("JSkit.Controller.create: "+n+" is a restricted keyword")})}function t(n,t){return g([n.namespace,n.channel,n.controllerEventName,t]).join(n.eventSeparator)}function e(n){F(n.actions,"all")||n.actions.unshift("all")}function r(n){n.__actions__=x(U(n.actions,function(n){return i(n)}))}function i(n){return q(n)?U(n,o):[o(n,n)]}function o(n,t){return{name:t,method:n}}function c(n,t){if(!N(n[t.method]))throw new Error(n.name+' action "'+t.name+":"+t.method+'" method is undefined')}function a(n){b(n.__actions__,function(e){c(n,e),n.dispatcher.on(t(n,e.name),n[e.method],n)})}function u(n){n.__elements__=L(n.elements,function(n,t,e){return n[e]=s(t),n},{})}function s(n){return L(n,function(n,t,e){return _.isArray(t)&&(t=j(t)),n[e]=t,n},{})}function f(n){n.__events__=L(n.elements,function(n,t,e){return n[e]=l(t),n},{})}function l(n){return L(n,function(n,t,e){return _.isArray(t)&&(n["$"+e]=O(t)),n},{})}function h(n){return document.querySelectorAll(n)}function m(n){var t=$?$:h;return t(n)}function v(n,t){if(!t)throw new Error("JSkit.Controller.cacheElements: action is undefined");var e=n.__elements__[t];e&&b(e,function(t,e){var r=n["$"+e]=m(t);if(!r.length)throw new Error("JSkit.Controller.cacheElements: "+t+" is not in the DOM")})}function p(n){n.cacheElements=function(t){return v(n,t)}}function d(n,t){b(n.__events__[t],function(e,r){n[r]||v(n,t),S(n,r,e)})}function S(n,t,e){var r=A(k(e),n),i=A($.prototype.on,n[t]);r(i)}function k(n){return n instanceof Function?n:function(t){var e=this;b(n,function(n,r){t(r,e[n])})}}function w(n){n.registerEvents=function(t){return d(n,t)}}function C(n){b(n.__actions__,function(e){var r=t(n,e.name);n.dispatcher.before(r,function(){return v(n,e.name)})})}function E(n){b(n.__actions__,function(e){var r=t(n,e.name);n.dispatcher.before(r,function(){return d(n,e.name)})})}var A=_.bind,J=_.bindAll,g=(_.cloneDeep,_.compact),y=_.defaults,b=_.each,D=_.extend,j=_.first,x=_.flatten,F=_.includes,N=(_.isArray,_.isFunction),q=_.isObject,z=_.keys,O=_.last,U=_.map,L=_.reduce,M=_.snakeCase;return{create:function(i){if(i=D({},i),!i.name)throw new Error("JSkit.Controller: name is undefined");n(i);var o=y(i,{actions:[],channel:"controller",controllerEventName:M(i.name),dispatcher:JSkit.Dispatcher.create(),elements:{},eventSeparator:":",namespace:"",initialize:function(){},all:function(){},eventNameForAction:function(n){return t(this,n)}});return b(functions(o)),J(o),e(o),r(o),a(o),f(o),u(o),E(o),C(o),p(o),w(o),o.initialize(),o}}}(),JSkit.Application=function(){function n(n){if(n=n||"",n.match(/_|-|\s/)){var t=e(n.split(/_|-|\s/g),function(n,t){return t>0?n.charAt(0).toUpperCase()+n.slice(1):n.toLowerCase()}).join("");n=t}else n=n.toString();return n.charAt(0).toUpperCase()+n.slice(1)}var t=_.extend,e=_.map;return{create:function(){var e=JSkit.Dispatcher.create();return{Controllers:{},Dispatcher:e,createController:function(r,i){if(i=i||{},!r)throw new Error("Application.createController(name, attrs): name is undefined");i.name=r;var o=n(r)+"Controller",c=this[o]={create:function(n){return n=n||{name:r},JSkit.Controller.create(t({},i,n))}};return this.Controllers[r]=c.create({dispatcher:e}),this.Controllers[r]}}}}}();